// Generated by CoffeeScript 1.6.2
var chatRoomController;

chatRoomController = {
  create: function(request, response) {
    return Object.create(this, {
      request: {
        value: request
      },
      response: {
        value: response
      }
    });
  },
  post: function() {
    var body,
      _this = this;

    body = "";
    this.request.addListener("data", function(chunk) {
      return body += chunk;
    });
    return this.request.addListener("end", function() {
      var data;

      data = JSON.parse(decodeURI(body)).data;
      return _this.chatRoom.addMessage(data.user, data.message).then(function() {
        _this.response.writeHead(201);
        return _this.response.end();
      }).done();
    });
  },
  get: function() {
    var id;

    id = this.request.headers["x-access-token"] || "0";
    return this.chatRoom.waitForMessagesSince(id);
  }
};

module.exports = chatRoomController;
